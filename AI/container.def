Bootstrap: docker
From: pytorch/pytorch:2.0.0-cuda11.7-cudnn8-runtime

%environment
    export LC_ALL=C
    export PATH=/opt/conda/bin:$PATH

%post
    # System packages
    apt-get update && apt-get install -y --no-install-recommends \
        build-essential \
        git \
        curl \
        vim \
        wget \
        ca-certificates \
        && rm -rf /var/lib/apt/lists/*

    # Python packages
    pip install --no-cache-dir --upgrade pip
    pip install --no-cache-dir \
        numpy \
        pandas \
        scikit-learn \
        matplotlib \
        seaborn \
        tqdm

    # PyTorch Geometric and related packages
    pip install --no-cache-dir torch-geometric
    
    # PyTorch Geometric dependencies
    pip install --no-cache-dir \
        pyg_lib \
        torch_scatter \
        torch_sparse \
        torch_cluster \
        torch_spline_conv \
        -f https://data.pyg.org/whl/torch-2.0.0+cu117.html
    
    # Any additional project-specific packages
    pip install --no-cache-dir \
        networkx \
        tensorboard

%runscript
    python "$@"

%test
    python -c "import torch; print('PyTorch version:', torch.__version__)"
    python -c "import torch_geometric; print('PyTorch Geometric version:', torch_geometric.__version__)"
    python -c "import torch; print('CUDA available:', torch.cuda.is_available())"